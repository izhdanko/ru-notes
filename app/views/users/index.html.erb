<h1>Список пользователей</h1>

<div class="mt-3">
  <%= render 'users_filter_form', search: @search, url: users_path %>
</div> 

<div class="mt-3">
  <table class="table table-striped table-bordered">
    <thead class="thead-dark">
      <tr>
        <th>ФИО</th>
        <th>Имя пользователя</th>
        <th>Регион</th>
        <th>Статус</th>
        <th>Действие</th>
        <th>Профиль</th>
      </tr>
    </thead>  

    <tbody>  
      <% @users.each do |user| %>
        <tr>
          <td><%= user.full_name %></td>
          <td><%= link_to user.username, user_path(user) %></td>
          <td>
            <% if user.admin? %>
              Все регионы
            <% else %>
              <%= user.region.name if user.region %>
            <% end %>
          </td>
          <td><%= user.admin? ? 'Администратор' : 'Обычный пользователь' %></td>
          <td>
            <% if current_user.admin? && (user.username != "admin" || !user.admin?) %>
              <% if user.admin? %>
                <%= link_to 'Сделать обычным', demote_from_admin_user_path(user), method: :patch, data: { confirm: 'Вы уверены?' }, class: "btn btn-primary" %>
              <% else %>
                <%= link_to 'Сделать администратором', promote_to_admin_user_path(user), method: :patch, data: { confirm: 'Вы уверены?' }, class: "btn btn-primary" %>
              <% end %>
            <% else %>
              <!-- Можно добавить здесь сообщение или другое содержимое для обычного пользователя. -->
            <% end %>
          </td>
          <td>
            <% unless user.username == "admin" %>
              <%= link_to 'Профиль', user_path(user), class: "btn btn-primary" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    </tbody>  
  </table>
</div>


  
